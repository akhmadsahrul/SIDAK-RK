{% extends "base_template.html" %}
{% block title %}Data Ajuan{% endblock %}


{% block content %}
<h2 class="mb-4"><i class="fas fa-tachometer-alt me-2"></i>Data Ajuan</h2>
            
            <div class="container my-4 p-4 bg-white rounded shadow">
                <!-- Filter & Pencarian -->
                <div class="row g-3 align-items-center mb-3">
                    <div class="col-md-6 col-12">
                        <label for="entries" class="form-label">Tampilkan</label>
                        <select id="entries" class="form-select w-auto d-inline-block">
                            <option value="5">5</option>
                            <option value="10" selected>10</option>
                            <option value="25">25</option>
                        </select>
                        <span>Entri</span>
                    </div>
                    <div class="col-md-6 col-12 text-md-end">
                        <input type="text" id="search" class="form-control" placeholder="Cari...">
                    </div>
                </div>
        
                <!-- Tabel Data -->
                <div class="table-responsive">
                    <table class="table table-bordered table-striped">
                        <thead class="table-thead" >
                            <tr>
                                <th>NIK</th>
                                <th>Nama Karyawan</th>
                                <th>Tipe Ajuan</th>
                                <th>Status</th>
                                <th>Bukti</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <!-- Data akan di-generate oleh JavaScript -->
                        </tbody>
                    </table>
                </div>
        
                <!-- Pagination -->
                <nav>
                    <ul class="pagination justify-content-center" id="pagination"></ul>
                </nav>
            </div>
        
            <script>
                document.addEventListener("DOMContentLoaded", function () {
                    const data = [
                        { nik: "351509080300042", nama: "Zahra Putri Fika", tipe: "Cuti", status: "Disetujui", bukti: "zahra.jpg" },
                        { nik: "351509080400041", nama: "Harry Kurniawan", tipe: "Cuti", status: "Ditolak", bukti: "harry.jpg" },
                        { nik: "351509030400023", nama: "Budi Santoso", tipe: "Sakit", status: "Disetujui", bukti: "budi.jpg" },
                        { nik: "351501059900056", nama: "Sukijan", tipe: "Cuti", status: "Disetujui", bukti: "suki.jpg" },
                        { nik: "351509030400021", nama: "Nawal Aulia", tipe: "Cuti", status: "Ditolak", bukti: "nawal.jpg" },
                        { nik: "351509030400067", nama: "Ahmad Sahrul", tipe: "Sakit", status: "Disetujui", bukti: "ahmad.jpg" },
                        { nik: "351509030400067", nama: "Alvin Riandi", tipe: "Cuti", status: "Ditolak", bukti: "alvin.jpg" },
                        { nik: "351509030400067", nama: "Hasan Basri", tipe: "Sakit", status: "Disetujui", bukti: "hasan.jpg" },
                        { nik: "351509030400090", nama: "Mark Zuckerberg", tipe: "Cuti", status: "Ditolak", bukti: "mark.jpg" },
                        { nik: "351509030400067", nama: "Naufal Indra", tipe: "Cuti", status: "Disetujui", bukti: "naufal.jpg" }
                    ];
        
                    let perPage = 10;
                    let currentPage = 1;
        
                    function renderTable(data) {
                        const tableBody = document.getElementById("tableBody");
                        tableBody.innerHTML = "";
        
                        let start = (currentPage - 1) * perPage;
                        let end = start + perPage;
                        let paginatedData = data.slice(start, end);
        
                        paginatedData.forEach(item => {
                            let row = `
                                <tr>
                                    <td>${item.nik}</td>
                                    <td>${item.nama}</td>
                                    <td>${item.tipe}</td>
                                    <td><span class="badge ${item.status === 'Disetujui' ? 'bg-success' : 'bg-danger'}">${item.status}</span></td>
                                    <td>${item.bukti}</td>
                                    <td>
                                        <button class="btn btn-primary btn-sm"><i class="fas fa-eye"></i></button>
                                        <button class="btn btn-danger btn-sm"><i class="fas fa-times"></i></button>
                                        <button class="btn btn-success btn-sm"><i class="fas fa-check"></i></button>
                                    </td>
                                </tr>
                            `;
                            tableBody.innerHTML += row;
                        });
                    }
        
                    function renderPagination(totalItems) {
                        const pagination = document.getElementById("pagination");
                        pagination.innerHTML = "";
                        let totalPages = Math.ceil(totalItems / perPage);
        
                        for (let i = 1; i <= totalPages; i++) {
                            let li = document.createElement("li");
                            li.classList.add("page-item");
                            if (i === currentPage) li.classList.add("active");
        
                            let a = document.createElement("a");
                            a.classList.add("page-link");
                            a.textContent = i;
                            a.href = "#";
                            a.addEventListener("click", function (e) {
                                e.preventDefault();
                                currentPage = i;
                                renderTable(data);
                                renderPagination(data.length);
                            });
        
                            li.appendChild(a);
                            pagination.appendChild(li);
                        }
                    }
        
                    document.getElementById("entries").addEventListener("change", function () {
                        perPage = parseInt(this.value);
                        currentPage = 1;
                        renderTable(data);
                        renderPagination(data.length);
                    });
        
                    document.getElementById("search").addEventListener("keyup", function () {
                        let searchTerm = this.value.toLowerCase();
                        let filteredData = data.filter(item => 
                            item.nik.toLowerCase().includes(searchTerm) ||
                            item.nama.toLowerCase().includes(searchTerm) ||
                            item.tipe.toLowerCase().includes(searchTerm) ||
                            item.status.toLowerCase().includes(searchTerm)
                        );
        
                        currentPage = 1;
                        renderTable(filteredData);
                        renderPagination(filteredData.length);
                    });
        
                    renderTable(data);
                    renderPagination(data.length);
                });
            </script>
            
{% endblock %}
